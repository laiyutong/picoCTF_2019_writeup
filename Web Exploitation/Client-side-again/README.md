<h1>Client-side-again</h1>
AUTHOR: DANNY<br>
POINTS: 200

<h2>Category</h2>
Web Exploitation

<h2>Problem Description</h2>
Can you break into this super secure portal?<br>
https://jupiter.challenges.picoctf.org/problem/56816/ or http://jupiter.challenges.picoctf.org:56816

<h2>Hints</h2>
What is <a href="https://en.wikipedia.org/wiki/Obfuscation_(software)">obfuscation</a>?

<h2>Solution</h2>
Inspect the code of script in DevTool and you can see the point as shown below.<br><br>
<img src="https://github.com/laiyutong/picoCTF_2019_writeup/blob/main/Web%20Exploitation/Client-side-again/script.png" alt="script">

Organize the <a href="https://github.com/laiyutong/picoCTF_2019_writeup/blob/main/Web%20Exploitation/Client-side-again/script.txt">script</a> first,
you will find <code>function verify()</code> is associated with <code> _0x4b5b</code>
that <code>_0x4b5b</code> is a function used to <code>obfuscate</code> different values.<br><br>
Using the <code>Console</code> query variable of the DevTool, the following results can be obtained.<br>

<pre class="text">
>> _0x4b5b('0x0')           >> _0x4b5b('0x5')
'getElementById'            '37115}'

>> _0x4b5b('0x1')           >> _0x4b5b('0x6')
'value'                     '_again_3'

>> _0x4b5b('0x2')           >> _0x4b5b('0x7')
'substring'                 'this'

>> _0x4b5b('0x3')           >> _0x4b5b('0x8')
'picoCTF{'                  'Password Verified'

>> _0x4b5b('0x4')           >> _0x4b5b('0x9')
'not_this'                  'Incorrect password'
</pre>


Replace all the variables related to <code> _0x4b5b</code> in the <a href="https://github.com/laiyutong/picoCTF_2019_writeup/blob/main/Web%20Exploitation/Client-side-again/script.txt">script</a>, and you will get the following code.<br>

<pre class="text">
function verify()
{
    checkpass=document[getElementById]('pass')[value];
    split=4;
    if(checkpass[substring](0,4*2)=='picoCTF{')
    {
        if(checkpass[substring](7,9)=='{n')
        {
            if(checkpass[substring](4*2,4*2*2)=='not_this' )
            {
                if(checkpass[substring](3,6)=='oCT')
                {
                    if(checkpass[substring](4*3*2,4*4*2)=='37115}')
                    {
                        if(checkpass['substring'](6,11)=='F{not')
                        {
                            if(checkpass[substring](4*2*2,4*3*2)=='_again_3')
                            {
                                if(checkpass[substring](12,16)=='this')
                                {
                                    alert('Password Verified');
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    else
    {
        alert('Incorrect password');
    }
}
</pre>


All partial strings are as follows：
<pre class="text">
                                                      1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3 3
                            pos： 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
(0,8)   ==  'picoCTF{'            p i c o C T F {
(7,9)   ==  '{n'                                { n
(8,16)  ==  'not_this'                            n o t _ t h i s
(3,6)   ==  'oCT'                       o C T
(24,32) ==  '37115}'                                                              3 7 1 1 5 }
(6,11)  ==  'F{not'                           F { n o t
(16,24) ==  '_again_3'                                            _ a g a i n _ 3
(12,16) ==  'this'                                        t h i s
</pre>
You can get the flag after rearranging the string！

<h2>Flag</h2>
<code>picoCTF{not_this_again_337115}</code>
